#!/usr/bin/env bash
set -eux

jlpm bootstrap

# Do a dev install of the server side
pushd python_packages/jupyter_lsp
python setup.py sdist bdist_wheel
python -m pip install -e . --ignore-installed --no-deps -vv
jupyter serverextension enable --sys-prefix --py jupyter_lsp
popd

# Install the labextension
pushd python_packages/jupyterlab_lsp
python setup.py sdist bdist_wheel
python -m pip install -e . --ignore-installed --no-deps -vv
jupyter labextension develop . --overwrite
popd

cd ~
mkdir ~/.jupyter
wget https://github.com/Kapral67/llvm-project/releases/download/v0.13.1/clangd_13.zip
7z x clangd_13.zip
cd ~/.jupyter
cp ~/clangd_13/jupyter_notebook_config.py .
cd ~
